.. _common.rst:

==============================
共通ルール: 基本
==============================

この章では、BlackPokerのすべての対戦で共通して使用される共通ルールを説明します。
フォーマットやフレームに関係なく、BlackPokerを遊ぶうえでの土台となるルールです。

プレイ人数、カードの種類、場の構成、アクションの処理など、ゲームの進行に必要な共通事項をまとめています。

※ フォーマットやフレームにより細かな違いがある場合は、フォーマットやフレーム側で補足されます。


プレイ人数
==============================
2人です。

用意するもの
==============================

* 1人1セットのトランプが必要です。
* 覚えていない場合、対戦レギュレーションに応じてアクションリストやキャラクターリストなどがあると便利です。


使用できるトランプ
==============================
BlackPokerでは次の条件を満たしたトランプを使うことができます。
一般的なトランプなら満たす条件となっています。

 * スートと数字が分かる
 * スートの♠♡♢♣が判断できる
 * 数字のA-K (1-13) が判断できる
 * スートと数字の組合せが重複していない
 * 裏から表がわからない
 * 縦向き横向きが判断できる
 * Jokerは2枚まで入れられる
 * 54枚無くてもよい

対戦レギュレーションにより使用できるトランプの枚数など異なる場合があるため、
対戦する際に、対戦レギュレーションを確認してください。


トランプの数字
==============================
ゲーム全体を通してトランプの数字は次のような数値として扱います。(:numref:`cardrank`)

.. _cardrank:
.. table:: トランプの数字

    +--------+------------+
    | カード |    数字    |
    +========+============+
    | A      | 1          |
    +--------+------------+
    | 2〜10  | 表記どおり |
    +--------+------------+
    | J      | 11         |
    +--------+------------+
    | Q      | 12         |
    +--------+------------+
    | K      | 13         |
    +--------+------------+
    | Joker  | 0          |
    +--------+------------+


.. index::
    single: り|領域
    single: ゾーン


.. _zone-section:

領域（ゾーン）
==============================

BlackPokerには、「領域(ゾーン)」と呼ぶ、カードを置く場所がいくつかあります。
各領域には配置可能なカード種類（コンポーネント）が定義されています。

.. index::
    single: ユニット条件
    single: ユニットカード
    single: ユニット

ゲーム中に配置されたカードのまとまりを「ユニット」と呼びます。  
ユニットを構成する各カードを「ユニットカード」と呼びます。  
そのユニットがどのコンポーネント定義（コンポーネントスクリプト）に対応するかはスクリプト側の
「ユニット条件」を参照してください。

領域ごとに存在するコンポーネントの一覧です。(:numref:`zone-component`)

.. _zone-component:
.. csv-table:: 領域ごとに存在するコンポーネント一覧
   :widths: 1, 1
   :header-rows: 1

    領域名,存在するコンポーネント
    場,キャラクター
    ライフ,ライフ
    墓地,墓地
    フォグ,フォグ
    手札,手札
    パック,パック
    レアカード,レアカード
    切札,切札

※ 表中では「ライフ」「墓地」「手札」などと記載しますが、「ライフ領域」「墓地領域」「手札領域」と呼んでも構いません。

各コンポーネントの詳細な定義や項目については、:numref:`common-component.rst` で詳しく説明します。


ここまでで「どの領域に」「どんなコンポーネントが置かれるか」を整理しました。  
次節では、実際のプレイ中にそれらがどのように配置されるかを図示して解説します。

カードの配置
==============================
カードの配置には次のような場所があります。(:numref:`field`)

※これらの領域は、フレームによって使用する領域が異なります。

.. _field:
.. figure:: ../frame/images/extra.*

    プレイ中のカードの配置

各領域で定義されたコンポーネントは、この配置図の対応する位置に置かれます。  
以下では主要な領域について説明します。

.. index::  
    single: ライフ

ライフ  
    山札。ゲームを始める時に自分のデッキを裏向きで置きます。  
    ダメージを受けるとライフの一番上から墓地にカードを移します。

.. index::  
    single: ぼ|墓地

墓地  
    捨て札置き場。ダメージを受けた時などに表向きでカードを重ねて置きます。

.. index::  
    single: ば|場

場  
    兵士や防壁などのキャラクターを置きます。

.. index::  
    single: て|手札

手札  
    ライフから引いたカードを持っておく場所です。相手から見えないようにしましょう。

.. index::  
    single: フォグ

フォグ  
    このターンのみ影響を与えるフォグを置きます。

.. index::  
    single: パック

パック  
    一部のフレームで使用される領域です。デッキから一部のカードを取り分けて伏せて置きます。  
    アクション（例：パック開封）によって順に使用されることがあります。

.. index::  
    single: レアカード

レアカード  
    特別な1枚を配置するための領域です。主にゲーム開始時に選ばれ、フレームによって使い方が異なります。  
    特定のアクション（例：レアドロー、レア召喚）と組み合わせて使われます。

.. index::  
    single: き|切札

切札  
    切札領域に配置するコンポーネントです。各カードに割り当てられた能力を活用でき、使用可能なフレームは個別に定義されます。



------------------------------
デッキとライフ
------------------------------
対戦レギュレーションなどでデッキという表現が出てきます。

.. index::
    single: デッキ

デッキ
    ゲーム開始前にゲームで使用するカードの束（カード構成）。
    フレームに応じて使用できるデッキの条件が異なります。

ゲームの始め方を経てデッキはライフとなります。詳細は :numref:`common_gamestart` で説明します。





勝利条件
==============================
プレイヤーは順に対戦相手に対し攻撃を行い、ダメージを与え先に相手のライフを0枚にした方が勝ちです。ダメージは1点につき、ライフが1枚減ります。

.. index::
    single: ダメージ

ダメージ
==============================
プレイヤーがダメージを受けた場合、ライフの一番上から受けた点数分墓地にカードを表向きで移動します。移動する際は、カードの表を対戦相手に見せる必要はありません。



.. _common_gamestart:

ゲームの始め方
==============================

BlackPokerでは、選択した「フレーム」に応じてゲームの開始手順が異なります。  
各フレームでは、「デッキ構築」や「初期配置」、「防壁・兵士のプリセット状態」などが個別に定義されています。  

そのため、ゲームを始める際は、まずフレームごとの「ゲームの始め方」に従って準備を行ってください。

各フレームに共通する手順を次に示します。ただし、エクストラではプリセット配置の手順が異なります。

.. _common_gamestart_preset:

------------------------------
共通手順：プリセット配置
------------------------------

#. ライフの一番上のカードを表向きにして「防壁」として場に出す。
#. 続けてライフの次のカードを表向きにして「兵士」として場に出す。

この手順は「プリセット」と呼ばれています。

.. _common_gamestart_first:

------------------------------
共通手順：先攻決定
------------------------------

#. 両者ライフの一番上のカードを表にする。
#. 数字の大きいプレイヤーが先攻（数値は :numref:`cardrank` を参照）。
#. 同じ数値の場合、さらにライフの一番上をめくって同様に比較。
#. 表にしたカードはすべて墓地に移す。

.. _common_gamestart_start:

------------------------------
共通手順：ゲーム開始
------------------------------

#. 先攻プレイヤーはライフから1枚引いて手札に加える。
#. 先攻プレイヤーがターンとチャンスを持ち、ゲームが開始される。


.. note:: ゲームの始め方の補足

    - フレームによっては、上記の「プリセット」や「先攻決定」「ゲーム開始」に入る前に、特別な手順（例：ストラテジー選択や切札設定など）があります。
    - 必ず対戦前に、使用するフレームの内容を確認してください。




基礎概念
==============================

ここまでで、BlackPokerを遊ぶための **土台** （人数・用具・トランプの条件と数字の扱い）、  
そして **どこに何を置くか** という場の構成（:ref:`zone-section`）と **ゲーム開始手順** を確認しました。

この節では、その土台の上でゲームを動かすために必要な **基本概念** を説明します。


----------------------------------------
まず、BlackPokerとは
----------------------------------------

BlackPoker は、 **標準的なトランプだけで遊べる、割込み可能なターン制のTCG風ゲーム** です。  
プレイヤーは **すること(アクション)** を宣言して処理を進め、 **盤面に存在するもの(コンポーネント/ユニット)** が増減・移動・状態変化していきます。

ゲームを動かす基礎は大きく **2つの概念** に分かれます。

- **コンポーネント**：盤面に存在しうる対象の総称。定義（= コンポーネントスクリプト）に合致する **ユニット** （実体）が場に現れます。
- **アクション**：プレイヤーが起こす行為の定義。実行したいときは **リクエスト** として宣言し、  
  リクエストは仮想的な場所（ **ステージ** ）で割込み可能に積み上がり、 **解決** された順で盤面へ反映されます。

要するに、 **アクションが盤面（コンポーネント/ユニット）を変え、盤面の状態が次のアクションの条件や対象を決める** ――この往復でゲームは進行します。  
この往復の **全体像** は :numref:`abstract-overview` を参照してください。ステージでのリクエスト処理の厳密な流れは、コアルール（:numref:`core.rst`）の基礎概念とコアフローを参照してください。

この節では、その土台の上でゲームを動かすために必要な **基本概念** を最短で共有します。  
読み進める道筋は次のとおりです。

- **対象の捉え方（何が“何として”存在するか）** → :numref:`common-component.rst`
- **やり取りの流れ（アクション／リクエストの処理系）** → :numref:`common-action.rst`

※ 個別のコンポーネントの詳細仕様は :numref:`common-component.rst` 、
　アクションの厳密な手順は :numref:`core.rst` を参照してください。


.. _abstract-overview:

.. figure:: images/abstract_editable_fixed.drawio.*
   :alt: 基礎概念の全体像（アクション／リクエストとコンポーネント／ユニット）
   :width: 100%

   **基礎概念の全体像**。左：仮想領域 **ステージ** 上にリクエストが積み上がる（割込み可、後入れ先出し）。  
   中央：**解決** により、有効な効果だけが処理される（対象喪失などは不発で解決）。  
   右：**盤面** に結果が反映され、カードのまとまり（**ユニット**）が、定義（**コンポーネントスクリプト**）の **ユニット条件** に一致すれば、その**コンポーネントとして扱われる**。

------------------------------------
図の読み方（要点）
------------------------------------

- **ステージ（左）**：アクションを起こすと **リクエスト** がここに積まれます。割込みが可能で、 **後入れ先出し** で解決します（詳細は :ref:`common-action.rst`）。  
- **解決フロー（中央）**：各リクエストは、対象の有効性・コスト・手順に従って**可能な部分だけ**処理されます。対象喪失などは**不発**で解決されます。  
- **盤面（右）**：解決結果のみが盤面へ反映され、**ユニット**（カードのまとまり）の状態や有無が更新されます。  
  どのユニットを何として扱うかは、**コンポーネントスクリプト**の **ユニット条件** が決めます（例：*一般兵* は「数字 2〜10」に一致するユニット）。

----------------------------------------------------
図に対応した最小プレイ例
----------------------------------------------------

1. A が「アップ（兵士）」を **リクエスト** → ステージに積まれる。  
2. B が割り込みで「ダウン（同じ兵士）」を **リクエスト** → ステージ上で B の方が上。  
3. **解決** ：先に B の「ダウン」が解決 → 兵士が墓地へ（盤面更新）。  
4. 次に A の「アップ」を解決しようとするが、 **対象ユニットを失って不発** で解決。  
   （この流れが :numref:`abstract-overview` の左→中央→右に相当します）


.. index::
   single: アクション
   single: リクエスト
   single: コンポーネント
   single: ユニット
   single: スクリプト
   single: コンポーネントスクリプト
   single: ユニット条件

用語の要点（最短定義）
------------------------------

アクション
  プレイヤーが行う**行為の種類の定義**です（例：アップ／ダウン／カウンター）。  
  実際に使うときは「この対象に、このタイミングで実行したい」と**リクエスト**します。  
  → 詳細は :numref:`common-action.rst` を参照。

リクエスト
  特定のアクションを実行するための**申請（インスタンス）**です。割込み可能で、許可・解決の流れで処理されます。  
  → 詳細は :numref:`common-action.rst` を参照。

コンポーネント
  **ゾーンに存在しうる対象の総称** です。  
  **比喩** ：将棋の「歩」は盤上に何枚あっても“歩という定義は1つ”。BlackPokerでも、1つの定義に対し複数の実体が対応します。  
  設計上は次の三層で扱います。  
  (1) **コンポーネント種別** （例：キャラクター／フォグ／切札…）  
  (2) **コンポーネントスクリプト** （個別の定義エントリ）  
  (3) **ユニット** （盤面に存在する実体）  
  → 概要と横断原則は :numref:`common-component.rst`、各種別の詳細は :numref:`common-component.rst` を参照。

スクリプト
  **定義の総称** （語源どおり“台本”の意味合いで、人間可読を前提）。  
  - アクションの定義 → **アクションスクリプト**  
  - コンポーネントの定義 → **コンポーネントスクリプト**

.. コンポーネントスクリプト（共通・必須項目）
..   すべてのコンポーネントスクリプトは、次の項目を**必ず**持ちます。  
..   - **領域（ゾーン）** ：このスクリプトが属するゾーン（:ref:`zone-section`）  
..   - **ユニット条件** ：盤面上のどのユニットをこのスクリプトの **コンポーネントとして扱うか** を決める条件  
..     - 例： **一般兵** （キャラクター）のユニット条件が「数字 2〜10」なら、盤面のユニットが2〜10のとき **一般兵として扱う**

ユニット
  盤面に存在する**実体**（1体＝1枚以上のカードのまとまり）。ユニットが上記**ユニット条件**に合致すると、そのスクリプトの**コンポーネント（種別）として扱われます**。
