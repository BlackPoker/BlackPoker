.. index::
    single: アクション

.. _common-action.rst:

共通ルール: アクション
==============================

BlackPokerは割込み可能なターン制ゲームです。

例えば次の状況をイメージしてください。

 - **Aくん**：「この兵士アップします。」  
 - **Bさん**：「その前にこの兵士ダウンします。」  
 - **Aくん**：「じゃあそのダウンをカウンターします。」  
 - **Bさん**：「それをさらにカウンターします。」  
 - **Aくん**：「・・・（泣）」  
 - **Bさん**：「（どやっ！）」  

このやり取りの中で「アップします」や「ダウンします」などの1行1行がアクションになります。

割込み可能なターン制ゲームは、見方を変えると“許可制のゲーム”とも表現できます。

このアクションを実行したいとルールシステムに要求(リクエスト)し、相手に許可を得てリクエストが実行されます。もちろん相手はリクエストに対して割り込んでリクエストすることもできます。

アクションには、プレイヤーのすべての行動を定義しており、従来のTCGでいう「魔法」や「ターン制御」が含まれています。

参考: :numref:`core.rst`

------------------------------
アクションが持つ項目
------------------------------
アクションが持つ項目について説明します。

.. 凡例の「サンプル」アクションを見てみましょう。(:numref:`action-sample`)

.. .. _action-sample:
.. .. figure:: images/action-sample.*

..     サンプルアクション

.. index::
    single: アクション名

アクション名
    アクションの名称を示します。


.. index::
    single: タイプ(アクション)

タイプ
    アクションの種類を表します。アクション名の後に括弧書きで記載します。


.. index::
    single: トリガー

トリガー
    アクションには自分で起こせるアクションと誘発するアクションがあります。
    トリガー項目では「直接」か「誘発」が設定されています。

    参考: :numref:`trigger_core`


.. index::
    single: スピード

スピード
    アクションはすぐに効果が解決されるものとそうでないものがあります。
    スピード項目では「即時」か「通常」が設定されています。

    参考: :numref:`speed_core`


.. index::
    single: タイミング

タイミング
    アクションは起こせるタイミングが2種類あります。「メイン」は自分のターンかつステージが空のときに起こせます。
    「クイック」はいつでも起こすことができます。

    参考: :numref:`timing`



.. index::
    single: キーカード条件

キーカード条件
    アクションの核となるカードを示します。
    キーカード条件は★で表記します。
    特に指定がない場合は、手札から選びます。
    兵士など場のカードを指定する場合は、その指定に従って選択してください。


.. index::
    single: コスト

コスト
    アクションを起こすのに必要な対価です。
    コストは＄を使って表記し、コストの支払いはアクションを起こすプレイヤーが行います。コストの種類は :numref:`cost` で説明します。


.. index::
    single: と|特記事項

特記事項
    特記事項は※を使って表記し、その他の項目では書き表せない条件を示します。


.. index::
    single: き|起動条件

起動条件
    起動するための条件を示します。


.. index::
    single: ゆ|誘発条件

誘発条件
    誘発する条件を示します。


.. index::
    single: た|対象

対象
    効果の対象を示します。


.. index::
    double: つ|通常効果;そ|即時効果

効果
 効果の内容を示します。


.. note:: トリガー,スピード,タイミングの表記

    トリガー,スピード,タイミングは@を使って次のように表記されます。

    @[トリガー]-[スピード]-[タイミング]

    例えば次のようになります。

    @誘発-即時-クイック


記載されていないアクションの項目
------------------------------------------------------------

アクションによっては記載されていない項目もあります。
記載されていない項目は無視して構いません。
たとえばコスト項目がなければコストを支払う必要はありません。


.. _cost:

------------------------------
コストの種類
------------------------------

アクションによって支払うコストが異なります。
コストには次の種類があり、それぞれ支払い方が異なります。(:numref:`table-cost`)

.. _table-cost:
.. table:: コストの種類

    +---------------+-----------------------------+
    |  表記(名称)   |            対価             |
    +===============+=============================+
    | B (Bulwark)   | 防壁をドライブする          |
    +---------------+-----------------------------+
    | L (Life)      | 1点ダメージを受ける         |
    +---------------+-----------------------------+
    | D (Discard)   | 手札を1枚捨てる             |
    +---------------+-----------------------------+
    | S (Sacrifice) | キャラクター1体を墓地に移す |
    +---------------+-----------------------------+
    | K (KeyDrive)  | キーカードをドライブする    |
    +---------------+-----------------------------+


たとえばコストが **「$BL」** の場合、自分の場にいるチャージ状態の防壁を1体ドライブし、1点ダメージを受けることでコストが支払われたことになります。

------------------------------------------------------------
アクションの起こし方(リクエスト)
------------------------------------------------------------

BlackPokerは実行したいアクションを要求(リクエスト)し、進める形式のゲームです。

アクションを要求することを「アクションを起こす」または「アクションをリクエストする」といいます。

次の手順でアクションをリクエストすることができます。

 #. 起こすアクションを対戦相手に伝える。
 #. アクションに応じたコストを支払う。
 #. 必要なら手札からキーカード条件に合ったカードを出し、キーカードとする。
 #. 対象の指定が必要な場合、対象を指定する。

.. 「サンプル」アクションを起こす例を見てみましょう。(:numref:`action-sample2`)

.. .. _action-sample2:
.. .. figure:: images/action-sample2.*

    .. アクションを起こす例

アクションを起こすときの注意点
------------------------------

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
対象を指定しないでアクションを起こせるか？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

「対象」項目がある場合、記載された条件を満たした対象を指定できなければ、
そのアクションを起こすことはできません。

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
アクションを対象とするアクションは自身を対象にできるか？
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

アクションは、自分自身を対象とすることはできません。
そのため、「カウンター」アクションのようにアクションを対象とするアクションは
自身を対象とすることはできません。

------------------------------
アクションの解決
------------------------------

リクエストされたアクションを実行済みにすることを「アクションを解決する」といいます。

実際にアクションが解決される流れを見ていきましょう。

**用語**

登場する用語を説明します。

**チャンス**
    アクションをリクエストする(ステージに積む)権利（他TCGの優先権）

**ターン**
    手番を示す印

**ステージ**
    アクションが蓄積される場所（他TCGのスタック）


1. プレイヤーAがアクションを積む

.. _action-request1-image:
.. figure:: images/action-request1.*

     アクションの解決1

2. プレイヤーBがアクションを積む

.. _action-request2-image:
.. figure:: images/action-request2.*

     アクションの解決2

3. アクションを実行（解決）

.. _action-request3-image:
.. figure:: images/action-request3.*

     アクションの解決3


大まかな流れは図の通りとなります。

更に厳密な処理は :numref:`coreflowsec` を参照してください。

.. :ref:`actresolve` に行うことを順に示します。

次に細かな部分を説明します。

補足ですが次に説明する部分は、 :numref:`coreflowsec` の :ref:`actresolve` で順に行われます。

対象条件を確認
------------------------------------------------------------
対象を指定するアクションが効果を発揮しようとした時に次の条件に該当する場合、効果を発揮する対象を失うため効果が発揮されず
アクションが解決されます。

 - 対象が存在していない場合
 - 対象が分裂した場合

たとえば兵士に対して「アップ」アクションを起こし、対応して「ダウン」
アクションを起こされました。
「ダウン」の方が先に解決されるため、「アップ」を解決する時には
兵士が墓地に移っていたとします。その場合、「アップ」アクションは効果を発揮せず解決されます。

「リバース」による対象分裂も同様です。
たとえば装備兵に対して「ツイスト」アクションを起こし、対応して「リバース」アクションを起こしたとします。
この場合、「リバース」が先に解決され、装備兵が分裂します。
その場合、「ツイスト」は対象を失いアクションの効果を発揮せず解決されます。


効果を発揮
------------------------------------------------------------
リクエストが解決する際に、アクションの効果に定義されている内容を実行します。
効果の中に実行不可能な部分がある場合、可能な部分のみ実行します。

たとえば、ライフの枚数が残1枚の時に5点のダメージを受けたとします。
ライフは1枚しかないので5点ダメージを受けることはできませんが、
1点までなら受けることが可能なため、
この場合1点のダメージを受けることになります。


解決は墓地移動までを含む
------------------------------------------------------------
「リクエストを解決する」という文言には、キーカードを墓地に移動し終えるまでが含まれています。

「リクエストを解決する」をまとめると次のようになります。

#. ステージの一番上にあるリクエストを特定する
#. リクエストの対象が正しいか確認する
#. 正しい場合、リクエストされたアクションの効果を可能な限り実行する
#. リクエストをステージから取り除く
#. キーカードを墓地に移す


ステージ上で効果を発揮
------------------------------------------------------------
アクションの効果を実行する際にリクエストはまだステージ上にあります。

効果の実行が完了した後、ステージ上から取り除かれます。


.. _keycard-gy:

キーカードを墓地に移す
------------------------------
効果を発揮した後、そのアクションをステージから取り除き、キーカードを墓地に移します。
ただし、次の場合はキーカードを墓地に移しません。

  * 効果の中でキーカードを場に出した場合  
  * 効果の中でキーカードを手札に戻した場合  
  * 支払いコストに K (KeyDrive) が含まれる場合は、キーカードをドライブ状態のままにする

------------------------------
勝敗判定
------------------------------

.. :ref:`winlose` で確認する内容は次になります。

アクションを解決するたびに勝敗判定が行われます。

勝敗はライフを確認し0枚の場合そのプレイヤーは敗北となります。

勝敗判定はターンプレイヤーから行われます。
もし、両プレイヤーのライフが0枚の場合、ターンプレイヤーの負けとなります。

補足ですがこの勝敗判定は、 :numref:`coreflowsec` の :ref:`winlose` で確認されます。


------------------------------
誘発チェック
------------------------------

アクションが解決された際に、
アクションの誘発条件に該当するとアクションが誘発されることがあります。

誘発とは、自動的にアクションがリクエストされることです。

BlackPokerの基本的なルールでは、次の2つの誘発パターンがほとんどです。

それ以外の場合は、:numref:`coreflowsec` を参照してください。


.. 誘発されるリクエストのコントローラー
.. ⇢コントローラーについてそもそも言及してなかった。。。


パターン1: フェイズ系
------------------------------

アタックアクションでは対象のアクションが解決すると次のアクションが誘発します。

1. アタック
2. ブロック
3. ダメージ判定

アタックアクションが解決すると、ブロックアクションが誘発します。

ブロックアクションが解決するとダメージ判定アクションが誘発します。

BlackPokerでは一般的なTCGではフェイズとして扱われるものも全てアクションとして定義されています。

同様に、エンド、チャージ、ドローアクションも定義されています。


パターン2: 世代交代
------------------------------

BlackPokerでは、Joker,A,J,Q,Kのカードが場から墓地に移った場合、世代交代というアクションが誘発します。

効果の内容はアクションリストを参照してください。

:numref:`act-nextGeneration`