## 複雑なルールを分解する

TCGのルールは非常に複雑である。

詳細なルールを理解しようとすると分厚いルールブックを正確に理解する必要がある。

私がこのゲームで実現したいことは次のようなやり取りをしたいからです。

===【コラム】なぜステージやチャンスといった複雑な手順があるか===

理由は、「対戦相手の行動に対して割り込むことを可能にするため」です。
いわばずる込みができます。たとえばこんな感じです。

- **Aくん**「この兵士アップします。」  
- **Bさん**「その前にこの兵士ダウンします。」  
- **Aくん**「じゃあそのダウンをカウンターします。」  
- **Bさん**「それをさらにカウンターします。」  
- **Aくん**「・・・（泣）」  
- **Bさん**「（どやっ！）」  

カードゲームの醍醐味はいかに相手の行動に対して意表をついた行動ができるかだと個人的には思っています。

行動の割り込みを可能にするため、カードゲームで用いられている手法を参考にし、さらにシンプルにしてBlackPokerに取り入れました。

カードゲームをやったことがある方は理解しやすいルールですが、今までカードゲームをやったことがない方には少し難しいルールかもしれません。ですが、ここで理解してしまえば他のカードゲームにも恐らく応用が利くので頑張って理解してみて下さい。

===

ルールは全員が理解している必要があるため簡単であることが望ましい。だが、複雑なやり取りはそれ自身に魅力がある。

一見複雑なルールをシンプルに整理できれば、みんなが魅力的なゲームで遊ぶことができると考えた。

TCGのルールは複雑で審判が必要になるほどだ。Q&Aのページも膨大で、全てのルールを細かく把握することはむずかしい。

ルールをシンプルにフローチャートなどの図を用いて説明できないかと考えた。

それをまとめたのが、以降に登場するコアフローとなる。

TCGのルールはフェイズという概念を用いることで全体の流れをわかりやすくしているが、フェイズがあるため、割り込み処理の説明が複雑になっている。

BlackPokerでは割り込み処理の説明を簡潔にし、フェイズの概念をなくした。

また、状態による処理も最小限にし、常に確認しなければならない箇所も減らした。

誘発については、まだ整理の余地があるが割り込み処理を整理したことで、比較的簡潔にまとめられており、更にこれから改善していく予定である。

ここからは、なぜ今までの複雑なルールがコアフローで表現できるかを解説する。

### ターンを印と捉える

詳しい説明の前に、ターンとチャンスについて考える必要がある。

TCGはターン制のゲームであるため、ターンは捉えやすいと思う。チャンスは優先権のことを指している。BlackPokerではアクションを起こせる機会のことをアクションチャンス、略してチャンスと命名している。

ターンという概念を捉える際に2つの捉え方がある。1つは期間、1つは印である。よくTCGでは「ターン終了時」という言葉が出てくる。ターンは期間であるように連想させられるが、ここでは印と捉えることにした。

ターンを期間と考えると色々矛盾が出てくる。シンプルにターンという印があり、それを持っているプレイヤーがその人の手番であると考えたほうがシンプルになる。

ターンを持っているプレイヤーのことをアクティブプレイヤー（AP）、ターンを持っていないプレイヤーのことをノンアクティブプレイヤー（NAP）と呼ぶ。この単語の定義をしないと後の説明が長文になるため、ご理解いただきたい。

ターンを印と捉えたのと同様にチャンスも印と捉えるとわかりやすい。

### アクションはプレイヤーの行動

TCGはカードが豊富に用意されている。たくさんのカードを手に入れるということは、多くのアクション（行動）を取ることを可能にする意味合いもある。

TCGのカードを分解すると、種類はプレイヤーのとれるアクションの種類と概ね同等になると考えられる。

BlackPokerでは、トランプを使っているため、カードの種類ではなく、アクションの種類を増やすことで、TCGの持つ豊富なカードプールを表現している。

コアフローでは、このアクションをどのように解決するかを整理している。

### フェイズはフローを複雑にする

多くのTCGでは、フェイズを用いてターン内で行えるプレイヤーの行動をわかりやすくしている。しかし、面白いTCGでは、相手の行動に対して多く干渉してくる。それは、フェイズも例外ではない。ターン終了時に重ねて割り込み処理をしたい。ターンの開始時にターンを持っているプレイヤーのキャラクターが再度利用可能になる。そのあとすぐに、利用不可の状態にしたい。

プレイヤーが様々な行動をできるようにルールを作成すると、フェイズで行う行動に対してもプレイヤーが干渉できるようになる。自由はルールを複雑にする。

BlackPokerでは、フェイズもプレイヤーがターン内に行えるアクション（行動）として捉え、TCGのカードが起こすアクションと同様に扱う。そうすることで、コアフローをシンプルにすることができた。

他のTCGではコアフローのようにフローチャート形式の図でルールを表現することは難しいと思う。フェイズは理解をしやすくするツールであり、根幹的には不要だと考えている。

### アクションの処理順を定義するステージ

BlackPokerではプレイヤーが起こしたアクションをステージという場所で管理する。TCGではスタックという呼ばれ方もする。BlackPokerでも初期の頃はスタックという名称にしていたが、もう少し広い意味で定義をしたいため、ステージという単語に変更した。

TCGのスタックは棚のイメージで考えられる。棚にものを詰めていくと先に詰めたものはあとから詰めたものが邪魔になり、取り出せなくなる。このことから先入れ後出し方式の意味となり、割り込み処理をする際にうまく機能する。

BlackPokerではステージとして、アクションが舞台に上がるイメージにした。舞台に上がりスポットライトが当たる。また誰かが舞台に上がりスポットライトが上がる。舞台から降りる順番は順不同だが、だいたい先入れ後出しのように動く。だが、先入れ後出しを強要しているわけではなく、スポットライトが当たる順番はルールによって変えられる。少し幅を持たせた表現にしている。